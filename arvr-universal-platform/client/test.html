<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR/VR Platform Test</title>
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 100%);
            color: white; 
            padding: 20px; 
            margin: 0;
            min-height: 100vh;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            background: linear-gradient(45deg, #6366f1, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .test-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        button { 
            padding: 12px 24px; 
            margin: 10px; 
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white; 
            border: none; 
            border-radius: 8px; 
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s ease;
            min-width: 150px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(99, 102, 241, 0.3);
        }
        
        button:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        #status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.3);
            min-height: 50px;
            font-size: 1.1rem;
        }
        
        .success { color: #10b981; }
        .error { color: #ef4444; }
        .warning { color: #f59e0b; }
        .info { color: #06b6d4; }
        
        .feature-list {
            text-align: left;
            margin: 20px 0;
        }
        
        .feature-item {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .logo {
            font-size: 4rem;
            margin-bottom: 1rem;
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .connection-test {
            background: rgba(6, 182, 212, 0.1);
            border-color: rgba(6, 182, 212, 0.3);
        }
        
        .device-test {
            background: rgba(16, 185, 129, 0.1);
            border-color: rgba(16, 185, 129, 0.3);
        }
        
        .ar-test {
            background: rgba(99, 102, 241, 0.1);
            border-color: rgba(99, 102, 241, 0.3);
        }
        
        .audio-test {
            background: rgba(139, 92, 246, 0.1);
            border-color: rgba(139, 92, 246, 0.3);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">üåê</div>
        <h1>Universal AR/VR Platform</h1>
        <p>Testing core functionality and browser compatibility</p>
        
        <div class="test-grid">
            <div class="test-card connection-test">
                <h3>üîó Connection Tests</h3>
                <button onclick="testWebRTC()">Test WebRTC</button>
                <button onclick="testWebSocket()">Test WebSocket</button>
                <button onclick="testHTTPS()">Test HTTPS</button>
            </div>
            
            <div class="test-card ar-test">
                <h3>ü•Ω AR/VR Tests</h3>
                <button onclick="testWebXR()">Test WebXR</button>
                <button onclick="testThreeJS()">Test Three.js</button>
                <button onclick="testFullscreen()">Test Fullscreen</button>
            </div>
            
            <div class="test-card device-test">
                <h3>üì± Device Tests</h3>
                <button onclick="testBluetooth()">Test Bluetooth</button>
                <button onclick="testUSB()">Test WebUSB</button>
                <button onclick="testNFC()">Test NFC</button>
            </div>
            
            <div class="test-card audio-test">
                <h3>üéµ Audio Tests</h3>
                <button onclick="testAudio()">Test Web Audio</button>
                <button onclick="testMicrophone()">Test Microphone</button>
                <button onclick="testSpatialAudio()">Test Spatial Audio</button>
            </div>
        </div>
        
        <div class="test-card">
            <h3>üìä System Information</h3>
            <button onclick="getSystemInfo()">Get System Info</button>
            <button onclick="testPerformance()">Test Performance</button>
            <button onclick="runAllTests()">üöÄ Run All Tests</button>
        </div>
        
        <div id="status">Click any test button to begin...</div>
        
        <div class="test-card">
            <h3>üõ†Ô∏è Browser Features</h3>
            <div class="feature-list" id="features">
                Loading feature detection...
            </div>
        </div>
    </div>

    <script>
        let testResults = {};
        
        // Feature detection on page load
        window.addEventListener('load', () => {
            detectFeatures();
            updateStatus('üéâ Test page loaded successfully! Ready for testing.', 'success');
        });
        
        function updateStatus(message, type = 'info') {
            const status = document.getElementById('status');
            status.innerHTML = message;
            status.className = type;
            console.log(`[${type.toUpperCase()}] ${message}`);
        }
        
        async function testWebXR() {
            updateStatus('üîç Testing WebXR support...', 'info');
            
            if (!navigator.xr) {
                updateStatus('‚ùå WebXR not supported in this browser', 'error');
                testResults.webxr = false;
                return;
            }
            
            try {
                const arSupported = await navigator.xr.isSessionSupported('immersive-ar');
                const vrSupported = await navigator.xr.isSessionSupported('immersive-vr');
                
                let message = '‚úÖ WebXR is supported! ';
                if (arSupported) message += 'AR ‚úÖ ';
                if (vrSupported) message += 'VR ‚úÖ ';
                if (!arSupported && !vrSupported) message += 'but no AR/VR sessions available';
                
                updateStatus(message, 'success');
                testResults.webxr = { ar: arSupported, vr: vrSupported };
            } catch (error) {
                updateStatus(`‚ùå WebXR test failed: ${error.message}`, 'error');
                testResults.webxr = false;
            }
        }
        
        async function testWebRTC() {
            updateStatus('üîç Testing WebRTC support...', 'info');
            
            if (!window.RTCPeerConnection) {
                updateStatus('‚ùå WebRTC not supported', 'error');
                testResults.webrtc = false;
                return;
            }
            
            try {
                const pc = new RTCPeerConnection();
                pc.close();
                updateStatus('‚úÖ WebRTC is supported and working!', 'success');
                testResults.webrtc = true;
            } catch (error) {
                updateStatus(`‚ùå WebRTC test failed: ${error.message}`, 'error');
                testResults.webrtc = false;
            }
        }
        
        async function testWebSocket() {
            updateStatus('üîç Testing WebSocket support...', 'info');
            
            if (!window.WebSocket) {
                updateStatus('‚ùå WebSocket not supported', 'error');
                testResults.websocket = false;
                return;
            }
            
            updateStatus('‚úÖ WebSocket is supported!', 'success');
            testResults.websocket = true;
        }
        
        async function testHTTPS() {
            updateStatus('üîç Testing HTTPS and security context...', 'info');
            
            const isSecure = location.protocol === 'https:' || location.hostname === 'localhost';
            const message = isSecure 
                ? '‚úÖ Secure context available (HTTPS or localhost)'
                : '‚ö†Ô∏è Not in secure context - some features may be limited';
            
            updateStatus(message, isSecure ? 'success' : 'warning');
            testResults.https = isSecure;
        }
        
        async function testThreeJS() {
            updateStatus('üîç Testing Three.js loading...', 'info');
            
            if (window.THREE) {
                updateStatus('‚úÖ Three.js is loaded and ready!', 'success');
                testResults.threejs = true;
            } else {
                updateStatus('‚ö†Ô∏è Three.js not loaded - loading from CDN...', 'warning');
                
                const script = document.createElement('script');
                script.src = 'https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js';
                script.onload = () => {
                    updateStatus('‚úÖ Three.js loaded successfully from CDN!', 'success');
                    testResults.threejs = true;
                };
                script.onerror = () => {
                    updateStatus('‚ùå Failed to load Three.js from CDN', 'error');
                    testResults.threejs = false;
                };
                document.head.appendChild(script);
            }
        }
        
        async function testBluetooth() {
            updateStatus('üîç Testing Web Bluetooth...', 'info');
            
            if (!navigator.bluetooth) {
                updateStatus('‚ùå Web Bluetooth not supported', 'error');
                testResults.bluetooth = false;
                return;
            }
            
            updateStatus('‚úÖ Web Bluetooth is supported!', 'success');
            testResults.bluetooth = true;
        }
        
        async function testUSB() {
            updateStatus('üîç Testing WebUSB...', 'info');
            
            if (!navigator.usb) {
                updateStatus('‚ùå WebUSB not supported', 'error');
                testResults.usb = false;
                return;
            }
            
            updateStatus('‚úÖ WebUSB is supported!', 'success');
            testResults.usb = true;
        }
        
        async function testNFC() {
            updateStatus('üîç Testing Web NFC...', 'info');
            
            if (!('NDEFReader' in window)) {
                updateStatus('‚ùå Web NFC not supported', 'error');
                testResults.nfc = false;
                return;
            }
            
            updateStatus('‚úÖ Web NFC is supported!', 'success');
            testResults.nfc = true;
        }
        
        async function testAudio() {
            updateStatus('üîç Testing Web Audio API...', 'info');
            
            if (!window.AudioContext && !window.webkitAudioContext) {
                updateStatus('‚ùå Web Audio API not supported', 'error');
                testResults.audio = false;
                return;
            }
            
            try {
                const AudioContextClass = window.AudioContext || window.webkitAudioContext;
                const audioContext = new AudioContextClass();
                audioContext.close();
                
                updateStatus('‚úÖ Web Audio API is working!', 'success');
                testResults.audio = true;
            } catch (error) {
                updateStatus(`‚ùå Web Audio API test failed: ${error.message}`, 'error');
                testResults.audio = false;
            }
        }
        
        async function testMicrophone() {
            updateStatus('üîç Testing microphone access...', 'info');
            
            if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
                updateStatus('‚ùå getUserMedia not supported', 'error');
                testResults.microphone = false;
                return;
            }
            
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                stream.getTracks().forEach(track => track.stop());
                updateStatus('‚úÖ Microphone access granted!', 'success');
                testResults.microphone = true;
            } catch (error) {
                updateStatus(`‚ö†Ô∏è Microphone access: ${error.message}`, 'warning');
                testResults.microphone = false;
            }
        }
        
        async function testSpatialAudio() {
            updateStatus('üîç Testing spatial audio capabilities...', 'info');
            
            if (!window.AudioContext && !window.webkitAudioContext) {
                updateStatus('‚ùå Spatial audio requires Web Audio API', 'error');
                testResults.spatialAudio = false;
                return;
            }
            
            try {
                const AudioContextClass = window.AudioContext || window.webkitAudioContext;
                const audioContext = new AudioContextClass();
                const panner = audioContext.createPanner();
                audioContext.close();
                
                updateStatus('‚úÖ Spatial audio (3D positioning) supported!', 'success');
                testResults.spatialAudio = true;
            } catch (error) {
                updateStatus(`‚ùå Spatial audio test failed: ${error.message}`, 'error');
                testResults.spatialAudio = false;
            }
        }
        
        async function testFullscreen() {
            updateStatus('üîç Testing fullscreen API...', 'info');
            
            if (!document.documentElement.requestFullscreen) {
                updateStatus('‚ùå Fullscreen API not supported', 'error');
                testResults.fullscreen = false;
                return;
            }
            
            updateStatus('‚úÖ Fullscreen API is supported!', 'success');
            testResults.fullscreen = true;
        }
        
        async function testPerformance() {
            updateStatus('üîç Running performance tests...', 'info');
            
            const start = performance.now();
            
            // Simple performance test
            let result = 0;
            for (let i = 0; i < 1000000; i++) {
                result += Math.random();
            }
            
            const end = performance.now();
            const duration = Math.round(end - start);
            
            updateStatus(`‚úÖ Performance test completed in ${duration}ms`, 'success');
            testResults.performance = duration;
        }
        
        function getSystemInfo() {
            updateStatus('üîç Gathering system information...', 'info');
            
            const info = {
                userAgent: navigator.userAgent,
                platform: navigator.platform,
                language: navigator.language,
                cookieEnabled: navigator.cookieEnabled,
                onlineStatus: navigator.onLine,
                screenResolution: `${screen.width}x${screen.height}`,
                viewport: `${window.innerWidth}x${window.innerHeight}`,
                pixelRatio: window.devicePixelRatio,
                touchSupport: 'ontouchstart' in window,
                webGL: !!window.WebGLRenderingContext
            };
            
            let infoText = '‚ÑπÔ∏è System Information:\n';
            Object.entries(info).forEach(([key, value]) => {
                infoText += `${key}: ${value}\n`;
            });
            
            updateStatus(infoText.replace(/\n/g, '<br>'), 'info');
            testResults.systemInfo = info;
        }
        
        async function runAllTests() {
            updateStatus('üöÄ Running comprehensive test suite...', 'info');
            
            const tests = [
                testWebXR, testWebRTC, testWebSocket, testHTTPS,
                testThreeJS, testBluetooth, testUSB, testNFC,
                testAudio, testMicrophone, testSpatialAudio, 
                testFullscreen, testPerformance
            ];
            
            for (const test of tests) {
                await test();
                await new Promise(resolve => setTimeout(resolve, 500)); // Small delay between tests
            }
            
            // Generate summary
            const passed = Object.values(testResults).filter(result => 
                result === true || (typeof result === 'object' && result !== null)
            ).length;
            const total = Object.keys(testResults).length;
            
            updateStatus(`üéâ Test suite completed! ${passed}/${total} tests passed`, 'success');
            console.log('Complete test results:', testResults);
        }
        
        function detectFeatures() {
            const features = {
                'WebXR Device API': !!navigator.xr,
                'WebRTC': !!window.RTCPeerConnection,
                'Web Audio API': !!(window.AudioContext || window.webkitAudioContext),
                'Web Bluetooth': !!navigator.bluetooth,
                'WebUSB': !!navigator.usb,
                'Web NFC': !!window.NDEFReader,
                'Service Workers': !!navigator.serviceWorker,
                'Push Notifications': !!window.PushManager,
                'WebGL': !!window.WebGLRenderingContext,
                'WebGL2': !!window.WebGL2RenderingContext,
                'WebAssembly': !!window.WebAssembly,
                'Fullscreen API': !!document.documentElement.requestFullscreen,
                'Screen Capture': !!(navigator.mediaDevices && navigator.mediaDevices.getDisplayMedia),
                'Device Orientation': !!window.DeviceOrientationEvent,
                'Geolocation': !!navigator.geolocation,
                'Vibration': !!navigator.vibrate,
                'Touch Events': 'ontouchstart' in window,
                'Pointer Events': !!window.PointerEvent
            };
            
            const featuresContainer = document.getElementById('features');
            featuresContainer.innerHTML = '';
            
            Object.entries(features).forEach(([feature, supported]) => {
                const item = document.createElement('div');
                item.className = 'feature-item';
                item.innerHTML = `
                    <span style="color: ${supported ? '#10b981' : '#ef4444'}">
                        ${supported ? '‚úÖ' : '‚ùå'}
                    </span>
                    ${feature}
                `;
                featuresContainer.appendChild(item);
            });
        }
    </script>
</body>
</html>
